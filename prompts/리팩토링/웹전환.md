새로운 브랜치 web_ver 을 만들고 그곳에 현재 구현된 electron에 대한 것들은 전부 삭제하고, 오직 웹버전으로 재시작할 것. 넥스트 js 프레임 워크를 사용하여 리팩토링 할 것. 현재 기능을 단 한계도 오류가 나거나 변형 시키지 말것.

---

# 웹 전환 리팩토링 상세 계획

## 1. 브랜치 및 환경 준비
- `web_ver` 브랜치를 `main`에서 분기하고 원격 저장소에 공유한다.
- Node.js LTS 버전과 의존성 버전을 문서화하고, Next.js용 ESLint/Tailwind 설정을 업데이트한다.
- 기존 CI 파이프라인이 새 브랜치에서도 동작하도록 점검하고 필요한 스크립트를 수정한다.

### 완료 기준
- `web_ver` 브랜치가 원격 저장소에 존재하며 기본 의존성 설치가 정상적으로 끝난다.
- CI가 `npm run lint`, `npm run test`, `npm run playwright:test`를 통과한다.

## 2. Electron 자산 정리
- `electron/` 디렉터리, 관련 preload/service 코드, Tray/clipboard 등 네이티브 의존성을 제거한다.
- `package.json`에서 Electron 관련 스크립트와 의존성을 정리하고, CRA 스크립트를 Next.js 전용 명령으로 교체한다.
- Electron 빌드 산출물을 생성하는 설정(`build`, `scripts/smoke`)을 정리하고 대체 경로를 마련한다.

### 완료 기준
- Electron 관련 파일이 모두 삭제되거나 보관 디렉터리로 이동된다.
- `npm install` 이후 Electron 패키지가 설치되지 않는다.

## 3. Next.js 골격 구축
- Next.js 14(App Router) 기반 구조를 도입하고, `/app` 디렉터리와 라우팅을 설정한다.
- 기존 CRA의 엔트리(`src/index.js`, `App.js`) 역할을 `/app/layout.jsx`, `/app/page.jsx` 등으로 분해한다.
- Tailwind, PostCSS, 전역 스타일(`App.css`, `theme/glass.css`)을 Next.js 방식으로 통합한다.

### 완료 기준
- `npm run dev`로 Next.js 개발 서버가 정상 구동되고 기본 페이지가 렌더링된다.
- 전역 스타일과 테마 전환이 Next.js 환경에서도 동일하게 동작한다.

## 4. 공통 인프라 계층 이관
- `shared`, `domain`, `infrastructure` 계층을 Next.js 환경에 맞게 Common module로 이동하며, 서버/클라이언트 경계를 명확히 정의한다.
- `shared/utils/platform` 등을 리팩터링하여 Electron 전제 로직을 제거하고 브라우저 기준으로 정돈한다.
- 설정/테마/Supabase Provider를 Next.js의 Server Components와 Client Components 구분에 맞게 재구성한다.

### 완료 기준
- 공통 훅과 유틸이 Next.js Client Component에서 문제없이 동작한다.
- Electron 전용 분기 로직이 제거되고 브라우저 기준 대비 코드만 남는다.

## 5. 주요 기능 모듈 이관
- `features/library`는 `/app/(library)/page.jsx` 혹은 동등한 라우트로 옮기며, 상태 관리와 데이터 의존성을 검증한다.
- `features/tree` 및 `treeCanvas`는 별도 라우트(`/app/widget/page.jsx`)로 분리하여 위젯 모드를 유지한다.
- Lazy 로딩 및 Suspense 전략을 Next.js Dynamic Import로 치환해 초기 로딩 속도를 유지한다.

### 완료 기준
- 라이브러리 화면과 위젯 화면이 동일한 기능·UI로 렌더링된다.
- 핵심 상호작용(노드 선택, 검색, 데이터 필터링 등)이 모두 통과한다.

## 6. 인증 및 Supabase 연동 재구성
- `SupabaseProvider`, `SupabaseAuthGate`, `OAuthCallbackPage`를 Next.js 라우트(`/app/auth/callback/route.js`) 및 서버 액션에 맞게 옮긴다.
- Supabase 환경 변수(`REACT_APP_*`)를 Next.js 규칙(`NEXT_PUBLIC_*`)에 맞춰 정리한다.
- 인증 콜백과 세션 유지 로직을 Next.js 미들웨어 또는 Route Handler로 구현한다.

### 완료 기준
- Supabase 로그인/로그아웃 플로우가 웹에서 동일하게 작동한다.
- 인증 후 리다이렉션 및 세션 갱신이 오류 없이 동작한다.

## 7. 백엔드 및 에이전트 프록시 연동
- `server/agent-proxy/server.mjs` 기능을 Next.js API Route 또는 독립적인 Edge Function으로 이전하고, CORS/보안 정책을 재검토한다.
- 웹 클라이언트에서 API 호출 경로를 `.env` 기반으로 구성하여 배포 환경에 맞게 조정한다.
- 필요한 경우 Supabase Edge Functions와의 연계를 점검한다.

### 완료 기준
- 웹 클라이언트에서 AI 에이전트 프록시 호출이 정상 응답을 반환한다.
- 기존 Electron 환경에서 사용하던 로컬 IPC 의존성이 완전히 제거된다.

## 8. 테스트 및 품질 보증
- 기존 단위 테스트를 Next.js 환경에 맞게 수정하고 커버리지를 검증한다.
- Playwright 시나리오를 웹 전용 플로우로 재작성하여 핵심 유스케이스(로그인, 채팅, 위젯)를 자동화한다.
- Lighthouse 및 Web Vitals 측정을 통해 성능 회귀를 검증한다.

### 완료 기준
- 테스트 스위트가 모두 통과하고, 회귀가 없음을 보고서로 남긴다.
- 성능 지표가 Electron 대비 동등하거나 개선된다.

## 9. 배포 전략 및 롤백 플랜
- Next.js 배포 대상(Vercel, Supabase Hosting 등)을 결정하고 인프라 구성을 문서화한다.
- 환경 변수 관리 전략(.env.local, Supabase Secret Manager 등)을 재정의한다.
- 이중 배포 기간 동안 Electron 버전 유지 여부와 롤백 절차를 명시한다.

### 완료 기준
- 배포 스크립트와 운영 체크리스트가 정리된 문서로 남는다.
- 장애 발생 시 롤백 절차가 10분 이내로 실행 가능하다.

## 10. 검증 및 인수 단계
- 이해관계자와 함께 기능 시연을 진행하고 승인 서명을 받는다.
- 문서(README, 아키텍처 다이어그램, 운영 가이드)를 최신 상태로 갱신한다.
- `web_ver` 브랜치를 메인라인에 병합하기 위한 PR 템플릿과 리뷰 체크리스트를 준비한다.

### 완료 기준
- 이해관계자 승인 기록이 남고, 배포 전 최종 QA가 완료된다.
- 병합 준비가 끝나고, 릴리스 노트가 작성된다.
