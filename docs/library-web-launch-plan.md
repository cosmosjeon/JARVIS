# 라이브러리 웹 앱 배포 계획

## 1. 목표
- 라이브러리 모드를 웹 독립 서비스 형태로 MVP 수준 출시하여 데스크톱(Electron) 앱과 병행 운영
- 최소 변경으로 공유 코드베이스를 유지하되, 웹 환경에서 필수 UX 차별화 요소 확보
- main 브랜치 기준으로 자동 배포가 가능한 CI/CD 파이프라인을 확립하고 운영 메뉴얼을 제공

## 2. 범위
### 2.1 MVP 필수 범위
- 웹 전용 진입 모드(`/?mode=library`) 기본화 및 미지정 시 리다이렉트 처리
- `REACT_APP_PLATFORM` 플래그와 `getPlatform()` 유틸 도입으로 web/electron 분기 체계 확립
- 웹 전용 헤더·사이드바 정비 및 최소 2단계 반응형 레이아웃 지원
- 파일 접근, OS 의존 기능 비활성화 등 웹에서 허용 가능한 기능 세트 정의
- Vercel 기반 호스팅 확정 및 `npm run build:web` 빌드 스크립트 설정
- Supabase OAuth 리다이렉트 URL, 환경 변수 분리(`.env.production`, `.env.electron`) 및 검증 체크리스트 작성
- 로그인, 트리 CRUD, 테마 전환, 반응형 동작에 대한 수동 QA 체크리스트와 Smoke 테스트 리포트 작성

### 2.2 릴리즈 이후 확장 범위
- 디자인 토큰 정리 및 Figma 싱크, Lighthouse/SEO 최적화, 웹 분석·Sentry 모니터링 도입
- Playwright/Cypress 기반 자동화 테스트, PWA 및 모바일 최적화, 사용자 피드백 채널 구축
- 운영 대시보드, 데이터 로깅 고도화 등 장기 과제

## 3. 추진 전략
### 3.1 플랫폼 분리 & 라우팅
- `.env.production`, `.env.electron`, `.env.local`에 `REACT_APP_PLATFORM` 플래그 정의
- `getPlatform()` 유틸 및 단위 테스트 작성 후 주요 레이아웃, 기능 분기에 적용
- `App.js`에서 플랫폼이 web일 때 `mode` 파라미터 미지정 시 `/?mode=library`로 리다이렉트, 잘못된 모드에 대한 폴백 로직 포함
- Electron 빌드(`widget` 기본)와 웹 빌드 동시 검증을 위한 smoke 스크립트 작성

### 3.2 웹 전용 UI/UX 커스터마이징
- 헤더에서 창 컨트롤·드래그 영역 제거 후 웹 브랜딩 반영, 데스크톱 스타일과 분리 유지
- 사이드바/패널 색상, 보더, 타이포그래피를 웹 톤으로 조정하고 1024px, 768px 기준 반응형 레이아웃 구축
- 파일 시스템, 클립보드 등 OS 의존 기능은 대체 메시지 또는 버튼 비활성화 처리
- 접근성 개선: `<Helmet>`을 활용한 타이틀/메타 태그 설정, 키보드 네비게이션 점검

### 3.3 빌드 & 배포 파이프라인
- `npm run build:web` 스크립트(`cross-env REACT_APP_PLATFORM=web react-scripts build`) 추가 및 빌드 산출물 검증
- Vercel 프로젝트 생성, main 브랜치 연동, 환경 변수 연계, `/?mode=library`를 기본 경로로 설정하는 Vercel 리라이트/리다이렉트 구성
- 프리뷰 브랜치 배포 설정으로 QA 테스트 환경 확보 후 main 머지 시 자동 배포 수행

### 3.4 인증 & 환경 구성
- Supabase OAuth 리다이렉트 URL에 웹 도메인을 등록하고 환경별 값(`local`, `staging`, `prod`)을 테이블로 관리
- 환경 변수 검증 스크립트 또는 npm 스크립트(`npm run check:env`) 도입으로 누락 감지
- 민감 정보는 Vercel 환경 변수로 관리하고 개발·운영 간 권한 분리 적용

### 3.5 QA 및 운영 준비
- 핵심 사용자 플로우(로그인, 트리 CRUD, 트리 뷰 탐색, 테마, 반응형)를 수동 체크리스트로 문서화
- PR 머지 전 Smoke 테스트(웹 빌드 실행 후 주요 플로우 클릭) 수행과 결과 기록
- 웹 장애 대응 시나리오, 롤백 절차, On-call 연락처 등 운영 가이드를 문서화
- Sentry, 사용자 분석 도구는 포스트-MVP 도입을 위한 백로그로 관리

## 4. 일정 및 마일스톤
| 단계 | 기간(주) | 주요 산출물 | 병행 여부 |
| --- | --- | --- | --- |
| 1. 플랫폼/환경 기초 | 1 | `REACT_APP_PLATFORM`, `getPlatform` 유틸, 라우팅 리다이렉트, .env 템플릿 | 단독 진행 |
| 2. UI/UX 커스터마이징 | 1 | 웹 전용 헤더·사이드바, 반응형 레이아웃, 기능 제한 처리 | 단계 1 완료 후 |
| 3. 배포 파이프라인 구축 | 0.5 | `npm run build:web`, Vercel 프로젝트, 환경 변수 연동, 리다이렉트 설정 | 단계 2와 병행 가능 |
| 4. QA & 스모크 테스트 | 0.5 | 수동 QA 체크리스트, Smoke 테스트 리포트 | 단계 2~3 산출물 기반 |
| 5. 문서화 & 릴리즈 | 0.5 | 배포 가이드, 환경 변수 표, 운영 절차 문서 | 최종 단계 |

## 5. 작업 테스크 상세
### 5.1 플랫폼 & 라우팅 (MVP)
- [ ] `.env.production`, `.env.electron`, `.env.local`에 `REACT_APP_PLATFORM` 기본값 정의
- [ ] `getPlatform()` 유틸 구현 및 단위 테스트 작성
- [ ] `App.js` 라이브러리 진입 리다이렉트 및 폴백 처리
- [ ] Electron 빌드와 웹 빌드가 모두 통과하는 Smoke 스크립트 실행

### 5.2 UI/UX 커스터마이징 (MVP)
- [ ] 웹 헤더에서 Electron 전용 UI 제거 및 브랜딩 반영
- [ ] 사이드바/패널 색상·타이포·여백 조정 및 반응형 레이아웃 적용(≥1024px, ≥768px 구간)
- [ ] 파일 시스템, 클립보드 등 미지원 기능에 안전한 비활성화/대체 메시지 처리
- [ ] `<Helmet>` 기반 타이틀·메타 태그 구성 및 주요 접근성 점검

### 5.3 배포 & 호스팅 (MVP)
- [ ] `npm run build:web` 스크립트 추가 및 산출물 검증
- [ ] Vercel 프로젝트 생성, main 브랜치와 연결, `/?mode=library` 기본 경로 설정
- [ ] Vercel 환경 변수 세팅 및 리뷰 앱(프리뷰 배포) 구성
- [ ] 배포 상태 확인용 `npm run status:web` 또는 간단한 헬스체크 문서화

### 5.4 인증 & 환경 (MVP)
- [ ] Supabase OAuth 리다이렉트 URL에 웹 도메인 추가 등록
- [ ] 환경 변수 매트릭스 문서화(`local/staging/prod` 표)
- [ ] `npm run check:env` 스크립트로 환경 변수 누락 검증
- [ ] 환경 값 배포 전 수동 검증 체크리스트 작성

### 5.5 QA & 운영 (MVP)
- [ ] 수동 QA 체크리스트 작성 및 저장소 공유 위치 명시
- [ ] Smoke 테스트 실행 후 결과 기록(스크린샷/노트)
- [ ] 운영 가이드(장애 대응, 롤백, 연락체계) 초안 작성

### 5.6 후속 과제 (포스트 MVP)
- [ ] 디자인 토큰 정리 및 Figma 싱크
- [ ] Lighthouse/SEO 최적화 및 성능 지표 수집 자동화
- [ ] Sentry/분석 도입 및 알림 정책 설정
- [ ] Playwright/Cypress 기반 자동화 테스트 도입
- [ ] PWA 및 모바일 최적화 검토, 사용자 피드백 채널 구축

## 6. 리스크 및 대응
- **플랫폼 별 기능 차이** → `getPlatform()` 분기 단위 테스트 및 Smoke 테스트 자동화, Electron 회귀 체크리스트 운영
- **OAuth/환경 변수 누락** → 환경 변수 매트릭스와 `npm run check:env`로 릴리즈 전 자동/수동 검증
- **배포 설정 오류** → Vercel 프로덕션/프리뷰 분리, 배포 전 `npm run build:web` 결과를 QA가 확인하도록 절차화
- **디자인 싱크 지연** → MVP 범위 내 우선순위만 확정하고 나머지는 후속 테스크(5.6)로 관리, 주간 디자인 리뷰 미팅 운영

## 7. 후속 과제
- PWA 및 모바일 최적화, 사용자 피드백 수집 채널 구축, 자동화 테스트 확대 등은 포스트 MVP 백로그에서 관리
- Sentry/분석 도구 도입과 디자인 토큰 정리는 완료 시 운영 문서에 업데이트
- 성능·접근성 지표를 릴리즈 후 지속 측정하여 다음 사이클 계획에 반영
